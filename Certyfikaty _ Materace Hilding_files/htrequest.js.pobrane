var http=createRequestObject();var inCall=false;var callToArray=new Array();var returnToArray=new Array();var paramsArray=new Array();var returnElementName="";var temp=0;var htreqCallBack=function(){}
var htreqCallBack2=function(){}
function createRequestObject(){if(window.XMLHttpRequest){reqObj=new XMLHttpRequest();}else if(window.ActiveXObject){reqObj=new ActiveXObject("Microsoft.XMLHTTP");}return reqObj;}function sendCall(whereTo,returnTo,postParams){callToArray.push(whereTo);returnToArray.push(returnTo);if(arguments.length>=3){paramsArray.push(postParams);}else{paramsArray.push('');}}function callQueue(){if(!inCall){if(callToArray.length>0){temp=1;whereTo=callToArray.shift();returnElementName=returnToArray.shift();postParams=paramsArray.shift();doCall(whereTo,postParams);}else{if(temp){temp=0;htreqCallBack();htreqCallBack=function(){}
htreqCallBack2();}}}}function doCall(whereTo,postParams){inCall=true;if(returnElementName=='*'){if(document.location==whereTo){document.location.reload();}document.location=whereTo;}else{if(postParams){http.open('post',whereTo);http.setRequestHeader("Content-Type","application/x-www-form-urlencoded");}else{http.open('get',whereTo);postParams=null;}http.onreadystatechange=stateChange;http.send(postParams);}}function stateChange(){if(http.readyState==4){response=http.responseText;if(returnElementName=='JSON_Data'){response=JSON.parse(http.responseText);for(u in response){if(document.getElementById(u)!=null){document.getElementById(u).value=response[u];}}}else{if(returnElementName!=''&&response!=''){try{document.getElementById(returnElementName).innerHTML=response;show_message('',returnElementName);}catch(e){}}}inCall=false;}}var queueWatcher=setInterval(callQueue,100);